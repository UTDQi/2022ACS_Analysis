---
title: "Using Ratio Estimator Approach To Estimate ACS Data" 
author: 
  - David Qi
thanks: "Code and data are available at: https://github.com/UTDQi/2022ACS_Analysis"
date: today
date-format: long
abstract: "This paper uses Ratio Estimator Approach on ACS 2022 data. Resulting in a estimation with large error. We then discusses possible reasons for error." 
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(knitr)

#load data
#general data
analysis_data = read_csv(here::here("data/analysis/result.csv"))
```


# Introduction

In this paper, we make use of R (@citeR) and the tidyverse package (@tidyverse) with supporting package dplyr(@dplyr) to analysis data form the 2022 ACS(American Community Surveys). The data set is from IPUMS (@ipumsusa). The table in our study are generated by knitr (@knitr). We have used some information form the book Telling Stories With Data(@tellingstories) on IPUMS and Ratio Estimator Approach. 

The remainder of this paper is structured as follows: We talk about how the data is gained under [Data](#sec-data) section. And describe the method of data estimation we use in the [Method](#method) section. Then, we provide a table that compares our estimation with actual data in the [Results](#results) section. We then discusses reason of error in estimation [Discussion](#discussion) section. 


# Data {#sec-data}

## Overview of dataset

The data can be obtained form (@ipumsusa) by the following steps:

1. Go to the IPUMS USA Home page(https://usa.ipums.org/usa/)
2. Click on "REGISTER", then follow the instructions and create an account
3. Log in to the created account, and go back to the Home page.
4. Click on "SELECT DATA"
5. Under the "HOUSEHOLD" drop down menu, select "GEOGRAPHIC"
6. Click on the $\bigoplus$ symbol beside the "STATEICP" Variable to add this variable to cart.
7. Under the "PERSON"drop down menu, select "EDUCATION"
8. Click on the $\bigoplus$ symbol beside the "EDUC" Variable to add this variable to cart.
9. Click on “SELECT SAMPLES” and select only the 2022 ACS sample, then click on "SUBMIT SAMPLE SELECTIONS"
10. Click on "CREATE DATA EXTRACT", on the next page, change the data format according to your needs. 
11. Click on "SUBMIT EXTRACT"
12. When the status of the data is "Completed", click on the download button beside it. 
13. The data is now downloaded, you may click on "Basic" under the "CODEBOOK" section beside this data to see how to understand this data.


# Method {#method}

## Ratio Estimator Approach {#ratio-approach}
  Ratio Estimator Approach is a method to estimate unknown data from what we know. We use this method to recreate the number of respondents for each state form the ratio between number of respondents and number of respondents that had a doctoral degree as their highest educational attainment in California. 
  
The number of respondents that had a doctoral degree as their highest educational attainment in California is:
$$
D_{71} = 6336
$$
The number of respondents in California is:
$$
R_{71} = 391171
$$
Which give us the Ratio:
$$
Ratio_{71} = \frac{391171}{6336}
$$

Then for any state $S$ with number of respondents that had a doctoral degree as their highest educational attainment $D_S$, we estimate the number of respondents in that state as:
$$
\hat{R_{S}} = \lfloor D_S \times \frac{391171}{6336} \rfloor
$$

Where $\lfloor\ \rfloor$ is the floor function that rounds a number to the largest integer smaller than it. 

# Results
We used the Ratio Estimator Approach to as defined in the [Method](#method) section. And compared it with the actual number of respondents in that state. 
(@tbl-compare) is the full table of estimated and actual number of participants in each state:
```{r}
#| label: tbl-compare
#| tbl-cap: Comparison of estimated and actual data
#| include: true
#| echo: false
#| warning: false
#| message: false

state_errors = analysis_data %>% select(STATENAME, estimated_respondents, actural_respondents,error)

kable(state_errors, col.names = c("State", "Estimated respondents" , "Actural respondents","Error"))
```



The mean of error($e_S = \hat{R_{S}} - R_{S}$) is: 
$$
\bar{e} = -12785.39
$$
And standard deviation is:
$$
\sigma(e) = 21219.03
$$

Also if we define mean percentage error ($\bar{P_e}$)by:
$$
\bar{P_e} = mean(R_s/e_s)
$$
We have 
$$
\bar{P_e} = -0.1955785
$$


# Discussion {#discussion}
  We see that the error is large for most states, and the average percentage error is at 19%. This is because educational status is different across states, different states have different ratio of people with doctor's degree. So our initial hypothesis to use ratio estimation was incorrect. 
  Form the negative mean error we see that California is a state with higher ratio of people who have a doctors degree. So using ratio estimation via the data form California will underestimate the number of respondents of most states. Some states, however, have even higher ratio of people with doctor degree, our estimation overestimated number of respondents for those. 

# Conclusion
  The result suggest that Ratio estimator using the data of people with doctor degree from a single state does not estimate the data well. Future studies can use more sophisticated ways of estimation, such as regression or neural networks. 
  
\newpage


\newpage

# References